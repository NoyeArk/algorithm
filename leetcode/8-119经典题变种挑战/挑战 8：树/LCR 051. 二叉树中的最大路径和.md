# [LCR 051. 二叉树中的最大路径和](https://leetcode.cn/problems/jC7MId/description/)

> **日期**：2025-07-26
> **所用时间**：11min

## 1. 递归

本题的关键在于理解“路径”可以从任意节点出发，到任意节点结束，但路径必须是连续的（只能沿父子方向，不能拐弯回头）。

- 对于每个节点，考虑两种情况：
    1. 该节点作为“路径的最高点”（即路径经过该节点，左子树和右子树都可以取）。
    2. 该节点作为“单边路径的一部分”（只能选择左子树或右子树，不能都选，否则路径会分叉）。

- 递归函数返回以当前节点为起点的最大单边路径和（即只能往下走一条路），但在递归过程中更新全局最大路径和（可以经过当前节点并同时取左右子树）。

在实现递归函数的过程中：

- 递归终止条件：节点为空，返回0。
- 递归计算左、右子树的最大单边路径和，如果小于0则取0（因为负数会拉低总和）。
- 更新全局最大路径和：`max(当前最大, 左单边+右单边+当前节点值)`。
- 返回当前节点为起点的最大单边路径和：`max(左单边, 右单边) + 当前节点值`。

复杂度分析：

- 时间复杂度: $O(n)$ ，每个节点只遍历一次
- 空间复杂度: $O(n)$ ，递归栈的深度

**Python3**

```python
class Solution:
    def maxPathSum(self, root: TreeNode) -> int:
        ans = -inf
        def dfs(root):
            if not root:
                return 0
            l = max(dfs(root.left), 0)
            r = max(dfs(root.right), 0)

            nonlocal ans
            ans = max(ans, l + r + root.val)
            return max(l, r) + root.val
        dfs(root)
        return ans
```