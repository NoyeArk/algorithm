# [3848. 阶数数字排列](https://leetcode.cn/problems/check-digitorial-permutation/)

> **日期**：2026-02-22  
> **所用时间**：10min  
> **知识点**：数学

## 1. 题目描述

给定一个正整数 `n`，定义其**阶数和**为：将 `n` 的每一位数字的阶乘相加得到的数。例如 `n = 145` 时，阶数和为 `1! + 4! + 5! = 1 + 24 + 120 = 145`。

判断：`n` 的阶数和 `s` 与 `n` 是否由**相同的一组数字**组成（即 `s` 的各位数字重排后能否得到 `n`，或等价地，`sorted(str(s)) == sorted(str(n))`）。

**示例 1：**

```
输入：n = 145
输出：true
解释：1!+4!+5! = 145，145 与 145 数字相同。
```

**示例 2：**

```
输入：n = 12
输出：false
解释：1!+2! = 3，数字 "3" 与 "12" 不同。
```

**提示：**

- `1 <= n <= 10^9`（或题目给定范围）

## 2. 阶乘求和 + 数字集合比较

先定义阶乘 `f(x) = x!`（`f(0)=1`），用记忆化避免重复计算。将 `n` 的每一位数字的阶乘相加得到 `s`，再比较 `s` 与 `n` 的**数字多重集**是否相同：即 `sorted(str(s)) == sorted(str(n))`。

复杂度分析：

- 时间复杂度：$O(\log n)$（位数），阶乘计算为常数次（0~9）。
- 空间复杂度：$O(1)$（阶乘缓存与数字串）。

**Python3**

```python
class Solution:
    def isDigitorialPermutation(self, n: int) -> bool:
        @cache
        def f(x):
            if x == 0:
                return 1
            return x * f(x - 1)

        s = sum(f(int(c)) for c in str(n))
        return sorted(str(s)) == sorted(str(n))
```