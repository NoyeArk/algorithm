# [1218. 最长定差子序列](https://leetcode.cn/problems/longest-arithmetic-subsequence-of-given-difference/description/)

> **日期:** 2025-09-14
> **所用时间:** 12min

## 1.动态规划

状态表示：$f[i]$ 表示以 $i$ 结尾的最长定差子序列的长度

状态计算：

我们用哈希表（或数组）记录以每个数结尾的最长定差子序列长度。对于当前数字 $x$，如果 $x-difference$ 之前已经出现过，则可以在以 $x-difference$ 结尾的子序列后面加上 $x$，长度加 $1$；否则以 $x$ 结尾的子序列长度为 $1$。遍历数组过程中不断更新最大长度即可。

$$
	f[i] = f[i - difference] + 1
$$

最终答案为 $max(f[i])$。

- 时间复杂度：$O(n)$
- 空间复杂度：$O(n)$

**Python3**

```python
class Solution:
    def longestSubsequence(self, arr: List[int], difference: int) -> int:
        f = defaultdict(int)
        ans = 0
        for x in arr:
            f[x] = f[x - difference] + 1
            ans = max(ans, f[x])
        return ans
```

**C++**

```C++
class Solution {
public:
    int f[40010];

    int longestSubsequence(vector<int>& arr, int difference) {
        int n = arr.size(), ans = 0;
        for (int i = 0; i < n; i ++)
        {
            int t = arr[i] + 20000;
            f[t] = f[t - difference] + 1;
            ans = max(ans, f[t]);
        }
        return ans;
    }
};
```