# [3453. 分割正方形 I](https://leetcode.cn/problems/separate-squares-i/description/)

> **日期**：2025-06-20  
> **所用时间**：10min  
> **知识点**：二分答案

## 1. 题目描述

有若干个边长为 $l$ 的正方形，坐标 $(x, y)$ 为左下角。你可以在这些正方形的顶边上选定一条平行于 $x$ 轴的水平直线 $y=\text{mid}$，这样会把所有被横线切到的正方形，分为上下两块。现要求找到这样一条横线，使得被横线切到正方形的所有**上侧部分面积之和**不超过所有正方形总面积的一半，并尽量靠下（$\text{mid}$尽量小）。返回此横线高度的最小值。

## 2. 二分答案

1. **二分答案**  
   由于随着横线高度 $\text{mid}$ 的增加，上侧部分面积会减少，存在单调性，因此可以用二分法枚举横线高度。

2. **check 检查条件**  
   - 对于每个正方形：
     - 如果上侧被分为 $h$ 高，则该正方形贡献的面积为 $\max(\min(y+l-\text{mid}, l), 0) \times l$。
     - 这代表被横线覆盖到的那一块高度，与正方形边界的重叠关系。
   - 累加所有正方形的"上侧"面积，判定是否 $\leq$ 总面积的一半。
   - 提前终止: 一旦总面积超标即可提前返回 `False`，加速判定。

3. **二分实现要点**  
   - 设二分区间 $[l, r]$ ：$l$ 为 0，$r$ 为所有正方形最顶端。
   - 精度要求到 $1e-5$。
   - 返回二分下界 $r$。

### 代码拆解

- 计算正方形的总面积。
- 定义检查函数 check：判定当前高度 $\text{mid}$ 是否可行。
- 二分高度，反复 check，收缩区间。

### 注意点

- 每个正方形都要考虑横线是否穿过自己，只统计被切到的（即底在 $y$、顶在 $y+l$）。
- $\max(\min(y+l-\text{mid}, l), 0)$ 用于保证面积不能负，且不能超出正方形本身边界。
- 精度细节，要求尽量靠下的分割线。

**复杂度分析**

- 时间复杂度: $O(n \log r)$
- 空间复杂度: $O(n)$

**Python3**

```python
class Solution:
    def separateSquares(self, squares: List[List[int]]) -> float:
        l = r = area_sum = 0.0
        for x, y, ll in squares:
            r = max(r, y + ll)
            area_sum += ll**2

        def check(mid):
            area = 0
            for x, y, l in squares:
                area += max(min(y + l - mid, l), 0) * l
                if 2 * area > area_sum:
                    return False
            return 2 * area <= area_sum

        while r - l > 1e-5:
            mid = (r + l) / 2
            if check(mid):
                r = mid
            else:
                l = mid
        return r
```