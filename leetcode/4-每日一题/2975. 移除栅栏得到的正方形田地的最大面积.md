# [2975. 移除栅栏得到的正方形田地的最大面积](https://leetcode.cn/problems/maximum-square-area-by-removing-fences-from-a-field/description/)

> **日期**：2026-01-16  
> **所用时间**：15min  
> **知识点**：枚举、哈希表

## 1. 题目描述

有一个大型的 $(m - 1) \times (n - 1)$ 矩形田地，其两个对角分别是 $(1, 1)$ 和 $(m, n)$ ，田地内部有一些水平栅栏和垂直栅栏，分别由数组 hFences 和 vFences 给出。

水平栅栏为坐标 $(hFences[i], 1)$ 到 $(hFences[i], n)$，垂直栅栏为坐标 $(1, vFences[i])$ 到 $(m, vFences[i])$ 。

返回通过 移除 一些栅栏（可能不移除）所能形成的最大面积的 正方形 田地的面积，或者如果无法形成正方形田地则返回 $-1$。

由于答案可能很大，所以请返回结果对 $10^9 + 7$ 取余 后的值。

注意：田地外围两个水平栅栏（坐标 $(1, 1)$ 到 $(1, n)$ 和坐标 $(m, 1)$ 到 $(m, n)$ ）以及两个垂直栅栏（坐标 $(1, 1)$ 到 $(m, 1)$ 和坐标 $(1, n)$ 到 $(m, n)$ ）所包围。这些栅栏 不能 被移除。

## 2. 枚举

### 思路分析

- 题目要求求移除部分栅栏后“能围成最大正方形田地”的最大面积。外圈的边界不能移除，只能移除中间的栅栏。
- “正方形田地”说明：必须有一段连续的横坐标（竖栅栏的间隔）和一段连续的纵坐标（横栅栏的间隔），且这两个长度要相等。
- **关键发现**：正方形边长 = 两个横栅栏之间的距离（或两个竖栅栏之间的距离）；要能恰好围出，就要横向有某个距离d，纵向也刚好有距离d，把所有这样的d找出来，取最大的那个。

#### 步骤：

1. **补齐田地范围的四条边**  
   输入的 hFences 和 vFences 不一定包含边界，所以要加上 `1` 和 `m`/`n`（对应行和列的外边界）。

2. **求所有可能的横向间距**  
   即 hFences 各两两之差的绝对值（所有可能的横向间隔），用 Set 记录，以便查找。

3. **求所有可能的纵向间距**  
   同理也求 vFences 各两两之差的绝对值。

4. **找横纵间隔都能取到的边长 d**  
   遍历所有纵向间隔，若某个 t 也出现在横向间隔，就更新最大正方形的面积 `t*t`。

5. **答案处理**  
   没有满足条件的返回 -1，否则对 $10^9+7$ 取余。

### 复杂度

- 时间复杂度：设横栅栏和竖栅栏各自数量为 $k$ 和 $l$，各自间隔是 $O(k^2)$ 和 $O(l^2)$，总复杂度 $O(k^2 + l^2)$，适合数据范围。
- 空间复杂度：$O(k + l)$，用于存储间隔。

### 示例讲解

假设 $hFences = [2, 5]$，$vFences = [3, 6]$，$m=7, n=9$：

- hFences 补边界后为 [1, 2, 5, 7]，所有间隔为 [1, 3, 2, 4, 5, 6]
- vFences 补边界后为 [1, 3, 6, 9]，所有间隔为 [2, 3, 5, 6, 7, 8]
- 两者都能取到的距离为 3, 5, 6
- 所以最大面积为 $6^2 = 36$

**Python3**

```python
class Solution:
    def maximizeSquareArea(self, m: int, n: int, hFences: List[int], vFences: List[int]) -> int:
        hFences += [1, m]
        mp = set()
        for i in range(len(hFences)):
            for j in range(i + 1, len(hFences)):
                mp.add(abs(hFences[j] - hFences[i]))

        vFences += [1, n]
        ans = -1
        for i in range(len(vFences)):
            for j in range(i + 1, len(vFences)):
                t = abs(vFences[j] - vFences[i])
                if t in mp:
                    ans = max(ans, t**2)
        return ans % int(1e9 + 7) if ans > -1 else -1
```