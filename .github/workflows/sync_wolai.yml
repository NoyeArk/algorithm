name: Wolai Markdown Metadata Sync
run-name: Syncing Markdown metadata with Wolai ğŸ“
on: [push]
jobs:
  Explore-GitHub-Actions:
    runs-on: ubuntu-latest
    steps:
      - name: "ğŸ›ï¸ æ£€å‡ºä»“åº“ä»£ç "
        uses: actions/checkout@v5

      - name: "ğŸ å®‰è£…ä¾èµ–"
        run: |
          pip install wolai

      - name: "ğŸ•µï¸ æ£€æŸ¥ Markdown æ–‡ä»¶å˜æ›´"
        id: changed-files
        uses: tj-actions/changed-files@v44

      - name: "ğŸ“„ List all changed files"
        run: |
            for file in ${{ steps.changed-files.outputs.all_changed_files }}; do
                echo "æ–‡ä»¶å˜æ›´: $file"
            done

      - name: "ğŸ“ Extract Markdown titles from changed files"
        run: |
            for file in ${{ steps.changed-files.outputs.all_changed_files }}; do
                if [[ "$file" == *.md ]]; then
                    echo "å¤„ç†æ–‡ä»¶: $file"
                    python3 scripts/sync_wolai.py --token "${{ secrets.WOLAI_API }}" --database_id "${{ secrets.WOLAI_DATABASE_ID }}" "$file"
                fi
            done